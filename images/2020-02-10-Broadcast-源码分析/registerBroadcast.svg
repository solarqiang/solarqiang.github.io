<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="649px" preserveAspectRatio="none" style="width:868px;height:649px;" version="1.1" viewBox="0 0 868 649" width="868px" zoomAndPan="magnify"><defs><filter height="300%" id="f1tm0ri8gohm3i" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="484.0371" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="122" y="107.1094"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="71.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="291" y="141.4199"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="319.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="461" y="242.3516"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="466" y="389.5938"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="644" y="313.9727"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="190.5527" style="stroke: #000000; stroke-width: 2.0;" width="488.5" x="368.5" y="342.9727"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126.5" x2="126.5" y1="38.4883" y2="609.1465"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="295.5" x2="295.5" y1="38.4883" y2="609.1465"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="465.5" x2="465.5" y1="38.4883" y2="609.1465"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="649" x2="649" y1="38.4883" y2="609.1465"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="782" x2="782" y1="38.4883" y2="609.1465"/><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="75.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="82.5" y="23.5352">ContextImpl</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="75.5" y="608.1465"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="82.5" y="628.6816">ContextImpl</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="91" x="248.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="255.5" y="23.5352">LoadedApk</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="91" x="248.5" y="608.1465"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="255.5" y="628.6816">LoadedApk</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="378.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="385.5" y="23.5352">ActivityManagerService</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="171" x="378.5" y="608.1465"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="385.5" y="628.6816">ActivityManagerService</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="591" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="598" y="23.5352">IntentResolver</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="591" y="608.1465"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="598" y="628.6816">IntentResolver</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="717" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="724" y="23.5352">BroadcastQueue</text><rect fill="#FEFECE" filter="url(#f1tm0ri8gohm3i)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="717" y="608.1465"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="724" y="628.6816">BroadcastQueue</text><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="484.0371" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="122" y="107.1094"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="71.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="291" y="141.4199"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="319.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="461" y="242.3516"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="466" y="389.5938"/><rect fill="#FFFFFF" filter="url(#f1tm0ri8gohm3i)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="644" y="313.9727"/><polygon fill="#A80036" points="115,65.7988,125,69.7988,115,73.7988,119,69.7988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="121" y1="69.7988" y2="69.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="10" y="65.0566">registerReceiver</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="127" x2="174" y1="94.1094" y2="94.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="174" x2="174" y1="94.1094" y2="107.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="174" y1="107.1094" y2="107.1094"/><polygon fill="#A80036" points="143,103.1094,133,107.1094,143,111.1094,139,107.1094" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="139" y="89.3672">registerReceiverInternal</text><polygon fill="#A80036" points="279,137.4199,289,141.4199,279,145.4199,283,141.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="132" x2="285" y1="141.4199" y2="141.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="139" y="136.6777">getReceiverDispatcher</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="301" x2="343" y1="170.7305" y2="170.7305"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="343" x2="343" y1="170.7305" y2="183.7305"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="302" x2="343" y1="183.7305" y2="183.7305"/><polygon fill="#A80036" points="312,179.7305,302,183.7305,312,187.7305,308,183.7305" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="308" y="165.9883">new receiverDispatcher</text><polygon fill="#A80036" points="143,209.041,133,213.041,143,217.041,139,213.041" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="137" x2="295" y1="213.041" y2="213.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="149" y="208.2988">IIntentReceiver</text><polygon fill="#A80036" points="449,238.3516,459,242.3516,449,246.3516,453,242.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="132" x2="455" y1="242.3516" y2="242.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="139" y="237.6094">registerReceiver</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="471" x2="513" y1="271.6621" y2="271.6621"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="513" x2="513" y1="271.6621" y2="284.6621"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="472" x2="513" y1="284.6621" y2="284.6621"/><polygon fill="#A80036" points="482,280.6621,472,284.6621,482,288.6621,478,284.6621" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="478" y="266.9199">new BroadcastFilter</text><polygon fill="#A80036" points="632,309.9727,642,313.9727,632,317.9727,636,313.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471" x2="638" y1="313.9727" y2="313.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="478" y="309.2305">addFilter</text><polygon fill="#A80036" points="482,323.9727,472,327.9727,482,331.9727,478,327.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="476" x2="648" y1="327.9727" y2="327.9727"/><path d="M368.5,342.9727 L435.5,342.9727 L435.5,349.9727 L425.5,359.9727 L368.5,359.9727 L368.5,342.9727 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="190.5527" style="stroke: #000000; stroke-width: 2.0;" width="488.5" x="368.5" y="342.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="383.5" y="356.541">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="450.5" y="355.6074">[AllSticky != null]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="518" y1="381.5938" y2="381.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="518" x2="518" y1="381.5938" y2="394.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="477" x2="518" y1="394.5938" y2="394.5938"/><polygon fill="#A80036" points="487,390.5938,477,394.5938,487,398.5938,483,394.5938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="483" y="376.8516">broadcastQueueForIntent</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="471" x2="513" y1="453.9043" y2="453.9043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="513" x2="513" y1="453.9043" y2="466.9043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="472" x2="513" y1="466.9043" y2="466.9043"/><polygon fill="#A80036" points="482,462.9043,472,466.9043,482,470.9043,478,466.9043" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="478" y="449.1621">new BroadcastRecord</text><polygon fill="#A80036" points="770,492.2148,780,496.2148,770,500.2148,774,496.2148" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471" x2="776" y1="496.2148" y2="496.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="478" y="491.4727">enqueueParallelBroadcastLocked</text><polygon fill="#A80036" points="770,521.5254,780,525.5254,770,529.5254,774,525.5254" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471" x2="776" y1="525.5254" y2="525.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="478" y="520.7832">scheduleBroadcastsLocked</text><polygon fill="#A80036" points="143,557.8359,133,561.8359,143,565.8359,139,561.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="137" x2="465" y1="561.8359" y2="561.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="149" y="557.0938">return sticky</text><polygon fill="#A80036" points="14,587.1465,4,591.1465,14,595.1465,10,591.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="8" x2="126" y1="591.1465" y2="591.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="20" y="586.4043">return sticky</text><!--
@startuml registerBroadcast
[-> ContextImpl: registerReceiver
ContextImpl -> ContextImpl ++: registerReceiverInternal
ContextImpl -> LoadedApk ++: getReceiverDispatcher
LoadedApk - ->  LoadedApk: new receiverDispatcher
return IIntentReceiver
ContextImpl -> ActivityManagerService ++: registerReceiver
ActivityManagerService - -> ActivityManagerService: new BroadcastFilter
ActivityManagerService -> IntentResolver ++: addFilter
return
opt AllSticky != null
ActivityManagerService -> ActivityManagerService ++: broadcastQueueForIntent
deactivate ActivityManagerService
ActivityManagerService - -> ActivityManagerService: new BroadcastRecord 
ActivityManagerService -> BroadcastQueue: enqueueParallelBroadcastLocked
ActivityManagerService -> BroadcastQueue: scheduleBroadcastsLocked
end
ActivityManagerService - -> ContextImpl - -: return sticky
ContextImpl - ->[: return sticky
deactivate ContextImpl
@enduml

PlantUML version 1.2019.09(Tue Aug 27 00:19:51 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 10.0.2+13
Operating System: Mac OS X
OS Version: 10.14.6
Default Encoding: US-ASCII
Language: zh
Country: CN
--></g></svg>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1106px" preserveAspectRatio="none" style="width:496px;height:1106px;" version="1.1" viewBox="0 0 496 1106" width="496px" zoomAndPan="magnify"><defs><filter height="300%" id="fnjhe1pyfys06" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="282.5" cy="20" fill="#000000" filter="url(#fnjhe1pyfys06)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fnjhe1pyfys06)" height="33.9688" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="218.5" y="94"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="223.5" x2="223.5" y1="94" y2="127.9688"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="341.5" x2="341.5" y1="94" y2="127.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="228.5" y="115.1387">等待消息或定时唤醒</text><rect fill="#FFFFFF" filter="url(#fnjhe1pyfys06)" height="174.668" style="stroke: #000000; stroke-width: 2.0;" width="168" x="204.5" y="138.7705"/><path d="M270.5,139.7705 L270.5,148.0674 L260.5,158.0674 L204.5,158.0674 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="207.5" y="152.7656">同步屏障</text><rect fill="#FEFECE" filter="url(#fnjhe1pyfys06)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="224.5" y="223.4697"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="234.5" y="244.6084">向前搜索异步消息</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="233,175.0674,332,175.0674,344,187.0674,332,199.0674,233,199.0674,221,187.0674,233,175.0674" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="286.5" y="209.2778">是</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="233" y="190.8755">当前消息是同步屏障</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="344" y="184.4731">否</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="282.5,277.4385,294.5,289.4385,282.5,301.4385,270.5,289.4385,282.5,277.4385" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fnjhe1pyfys06)" height="224.2656" style="stroke: #000000; stroke-width: 2.0;" width="422" x="36" y="324.2402"/><path d="M130,325.2402 L130,333.5371 L120,343.5371 L36,343.5371 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="39" y="338.2354">判断消息状态</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="249.5,360.5371,315.5,360.5371,327.5,372.5371,315.5,384.5371,249.5,384.5371,237.5,372.5371,249.5,360.5371" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="249.5" y="376.3452">当前消息非空</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="226.5" y="369.9429">是</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="327.5" y="369.9429">否</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="122,394.5371,232,394.5371,244,406.5371,232,418.5371,122,418.5371,110,406.5371,122,394.5371" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="110" x="122" y="410.3452">当前消息到了处理时间</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="99" y="403.9429">是</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="244" y="403.9429">否</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="76,428.5371,134,428.5371,124,462.5059,66,462.5059" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="76" y="449.6758">返回消息</text><ellipse cx="100" cy="492.5059" fill="#FFFFFF" filter="url(#fnjhe1pyfys06)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="93.8128" x2="106.1872" y1="486.3187" y2="498.693"/><line style="stroke: #000000; stroke-width: 2.5;" x1="106.1872" x2="93.8128" y1="486.3187" y2="498.693"/><rect fill="#FEFECE" filter="url(#fnjhe1pyfys06)" height="33.9688" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="208" y="428.5371"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="218" y="449.6758">设置定时唤醒</text><rect fill="#FEFECE" filter="url(#fnjhe1pyfys06)" height="33.9688" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="330" y="394.5371"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="340" y="415.6758">设置无限等待消息</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="282.5,512.5059,294.5,524.5059,282.5,536.5059,270.5,524.5059,282.5,512.5059" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fnjhe1pyfys06)" height="248.6367" style="stroke: #000000; stroke-width: 2.0;" width="153" x="216.5" y="569.1191"/><path d="M282.5,570.1191 L282.5,578.416 L272.5,588.416 L216.5,588.416 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="219.5" y="583.1143">退出循环</text><rect fill="#FEFECE" filter="url(#fnjhe1pyfys06)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="248.5" y="653.8184"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="258.5" y="674.957">清理现场</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="257.5,707.7871,317.5,707.7871,307.5,741.7559,247.5,741.7559" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="50" x="257.5" y="728.9258">返回 null</text><ellipse cx="282.5" cy="772.7559" fill="#FFFFFF" filter="url(#fnjhe1pyfys06)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="282.5" cy="772.7559" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="238.5,605.416,326.5,605.416,338.5,617.416,326.5,629.416,238.5,629.416,226.5,617.416,238.5,605.416" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="286.5" y="639.6265">是</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="88" x="238.5" y="621.2241">需要退出消息循环</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="338.5" y="614.8218">否</text><rect fill="#FFFFFF" filter="url(#fnjhe1pyfys06)" height="243.6367" style="stroke: #000000; stroke-width: 2.0;" width="178.5" x="203" y="828.5576"/><path d="M290,829.5576 L290,837.8545 L280,847.8545 L203,847.8545 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="206" y="842.5527">IdleHandler</text><rect fill="#FEFECE" filter="url(#fnjhe1pyfys06)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="223" y="913.2568"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="233" y="934.3955">处理 IdleHandler</text><rect fill="#FEFECE" filter="url(#fnjhe1pyfys06)" height="33.9688" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="236.5" y="982.2256"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="246.5" y="1003.3643">设置立即唤醒</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="226.5,864.8545,338.5,864.8545,350.5,876.8545,338.5,888.8545,226.5,888.8545,214.5,876.8545,226.5,864.8545" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="286.5" y="899.0649">是</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="112" x="226.5" y="880.6626">需要处理 IdleHandler</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="11" x="350.5" y="874.2603">否</text><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="282.5,1036.1943,294.5,1048.1943,282.5,1060.1943,270.5,1048.1943,282.5,1036.1943" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#fnjhe1pyfys06)" points="270.5,50,294.5,50,306.5,62,294.5,74,270.5,74,258.5,62,270.5,50" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="271" y="65.8081">true</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="199.0674" y2="223.4697"/><polygon fill="#A80036" points="278.5,213.4697,282.5,223.4697,286.5,213.4697,282.5,217.4697" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="344" x2="356" y1="187.0674" y2="187.0674"/><polygon fill="#A80036" points="352,230.4541,356,240.4541,360,230.4541,356,234.4541" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356" x2="356" y1="187.0674" y2="289.4385"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356" x2="294.5" y1="289.4385" y2="289.4385"/><polygon fill="#A80036" points="304.5,285.4385,294.5,289.4385,304.5,293.4385,300.5,289.4385" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="257.4385" y2="277.4385"/><polygon fill="#A80036" points="278.5,267.4385,282.5,277.4385,286.5,267.4385,282.5,271.4385" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="127.9688" y2="175.0674"/><polygon fill="#A80036" points="278.5,165.0674,282.5,175.0674,286.5,165.0674,282.5,169.0674" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="100" x2="100" y1="462.5059" y2="482.5059"/><polygon fill="#A80036" points="96,472.5059,100,482.5059,104,472.5059,100,476.5059" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="110" x2="100" y1="406.5371" y2="406.5371"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="100" x2="100" y1="406.5371" y2="428.5371"/><polygon fill="#A80036" points="96,418.5371,100,428.5371,104,418.5371,100,422.5371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="244" x2="254" y1="406.5371" y2="406.5371"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="254" x2="254" y1="406.5371" y2="428.5371"/><polygon fill="#A80036" points="250,418.5371,254,428.5371,258,418.5371,254,422.5371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="254" x2="254" y1="462.5059" y2="524.5059"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="254" x2="270.5" y1="524.5059" y2="524.5059"/><polygon fill="#A80036" points="260.5,520.5059,270.5,524.5059,260.5,528.5059,264.5,524.5059" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="237.5" x2="177" y1="372.5371" y2="372.5371"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="177" x2="177" y1="372.5371" y2="394.5371"/><polygon fill="#A80036" points="173,384.5371,177,394.5371,181,384.5371,177,388.5371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="327.5" x2="388" y1="372.5371" y2="372.5371"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="388" x2="388" y1="372.5371" y2="394.5371"/><polygon fill="#A80036" points="384,384.5371,388,394.5371,392,384.5371,388,388.5371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="388" x2="388" y1="428.5059" y2="524.5059"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="388" x2="294.5" y1="524.5059" y2="524.5059"/><polygon fill="#A80036" points="304.5,520.5059,294.5,524.5059,304.5,528.5059,300.5,524.5059" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="301.4385" y2="360.5371"/><polygon fill="#A80036" points="278.5,350.5371,282.5,360.5371,286.5,350.5371,282.5,354.5371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="687.7871" y2="707.7871"/><polygon fill="#A80036" points="278.5,697.7871,282.5,707.7871,286.5,697.7871,282.5,701.7871" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="741.7559" y2="761.7559"/><polygon fill="#A80036" points="278.5,751.7559,282.5,761.7559,286.5,751.7559,282.5,755.7559" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="629.416" y2="653.8184"/><polygon fill="#A80036" points="278.5,643.8184,282.5,653.8184,286.5,643.8184,282.5,647.8184" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="338.5" x2="350.5" y1="617.416" y2="617.416"/><polygon fill="#A80036" points="346.5,705.7871,350.5,715.7871,354.5,705.7871,350.5,709.7871" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="350.5" x2="350.5" y1="617.416" y2="805.7559"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="350.5" x2="282.5" y1="805.7559" y2="805.7559"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="805.7559" y2="864.8545"/><polygon fill="#A80036" points="278.5,854.8545,282.5,864.8545,286.5,854.8545,282.5,858.8545" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="536.5059" y2="605.416"/><polygon fill="#A80036" points="278.5,595.416,282.5,605.416,286.5,595.416,282.5,599.416" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="947.2256" y2="982.2256"/><polygon fill="#A80036" points="278.5,972.2256,282.5,982.2256,286.5,972.2256,282.5,976.2256" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="888.8545" y2="913.2568"/><polygon fill="#A80036" points="278.5,903.2568,282.5,913.2568,286.5,903.2568,282.5,907.2568" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="350.5" x2="362.5" y1="876.8545" y2="876.8545"/><polygon fill="#A80036" points="358.5,954.7256,362.5,964.7256,366.5,954.7256,362.5,958.7256" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="362.5" x2="362.5" y1="876.8545" y2="1048.1943"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="362.5" x2="294.5" y1="1048.1943" y2="1048.1943"/><polygon fill="#A80036" points="304.5,1044.1943,294.5,1048.1943,304.5,1052.1943,300.5,1048.1943" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="1016.1943" y2="1036.1943"/><polygon fill="#A80036" points="278.5,1026.1943,282.5,1036.1943,286.5,1026.1943,282.5,1030.1943" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="74" y2="94"/><polygon fill="#A80036" points="278.5,84,282.5,94,286.5,84,282.5,88" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="1060.1943" y2="1082.1943"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="470" y1="1082.1943" y2="1082.1943"/><polygon fill="#A80036" points="466,572.5059,470,562.5059,474,572.5059,470,568.5059" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="470" x2="470" y1="62" y2="1082.1943"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="470" x2="306.5" y1="62" y2="62"/><polygon fill="#A80036" points="316.5,58,306.5,62,316.5,66,312.5,62" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="258.5" x2="24" y1="62" y2="62"/><polygon fill="#A80036" points="20,558.5059,24,568.5059,28,558.5059,24,562.5059" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="24" x2="24" y1="62" y2="1094.1943"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="24" x2="282.5" y1="1094.1943" y2="1094.1943"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="282.5" y1="30" y2="50"/><polygon fill="#A80036" points="278.5,40,282.5,50,286.5,40,282.5,44" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[cf5aac782a6ad6684e0b10b738bc8887]
@startuml
start
while (true)
    :等待消息或定时唤醒|

partition 同步屏障 {
    if(当前消息是同步屏障) then (是)
        :向前搜索异步消息;
    else (否)
    endif
}

partition 判断消息状态 {
    if (当前消息非空) then (是)
        if(当前消息到了处理时间) then (是)
            :返回消息/
            end
        else (否)
            :设置定时唤醒]
        endif
    else (否)
        :设置无限等待消息]
    endif
}

partition 退出循环 {
    if (需要退出消息循环) then (是)
        :清理现场;
        :返回 null/
        stop
    else (否)
    endif
}

partition IdleHandler {
    if (需要处理 IdleHandler) then (是)
        :处理 IdleHandler;
        :设置立即唤醒]
    else (否)
    endif
}
endwhile
detach
@enduml

PlantUML version 1.2020.00(Sat Jan 11 12:30:53 UTC 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>